<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>HATU - H·ªèi ƒê√°p Thi√™n VƒÉn</title>
  <style>
    body {
      background-color: #0d0d0d;
      color: #ffffff;
      font-family: 'Segoe UI', sans-serif;
      margin: 0;
      padding: 20px;
    }
    h1 {
      color: #00bcd4;
      text-align: center;
    }
    .container {
      max-width: 800px;
      margin: 0 auto;
    }
    .question-box, .answer-box {
      background: #1a1a1a;
      padding: 15px;
      margin-bottom: 20px;
      border-radius: 12px;
      box-shadow: 0 0 10px #00bcd4;
    }
    .input-field, textarea {
      width: 100%;
      padding: 10px;
      margin-top: 10px;
      border-radius: 6px;
      border: none;
      background: #333;
      color: #fff;
    }
    .button {
      background-color: #00bcd4;
      color: white;
      border: none;
      padding: 10px 20px;
      border-radius: 6px;
      cursor: pointer;
      margin-top: 10px;
    }
    .button:hover {
      background-color: #008ba3;
    }
    .qa h2 {
      color: #ffc107;
      margin-bottom: 15px;
    }
    .qa h3 {
      color: #f0f0f0;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>ü™ê HATU - H·ªèi ƒê√°p Thi√™n VƒÉn</h1>

    <div class="question-box">
      <h2>ƒê·∫∑t c√¢u h·ªèi</h2>
      <input type="text" class="input-field" id="username" placeholder="T√™n c·ªßa b·∫°n (b·∫Øt bu·ªôc)">
      <textarea rows="4" id="question" class="input-field" placeholder="Nh·∫≠p c√¢u h·ªèi c·ªßa b·∫°n v·ªÅ thi√™n vƒÉn..."></textarea>
      <button class="button" onclick="submitQuestion()">G·ª≠i c√¢u h·ªèi</button>
    </div>

    <div class="qa" id="qa-section">
      <h2>C√°c c√¢u h·ªèi ƒë√£ g·ª≠i:</h2>
      <!-- N·ªôi dung c√¢u h·ªèi s·∫Ω ƒë∆∞·ª£c ch√®n ·ªü ƒë√¢y -->
    </div>
  </div>

  <script>
    const sheetID = '1_9eNkQEo7EnAYcs9LqQQ9U232PUeylmjrKNv_eGOUX0';
    const sheetName = 'C√¢u tr·∫£ l·ªùi bi·ªÉu m·∫´u 1'; // ƒê·ªïi t√™n n·∫øu b·∫°n ƒë·∫∑t l·∫°i
    const sheetURL = `https://opensheet.elk.sh/${sheetID}/${sheetName}`;
    const qaSection = document.getElementById('qa-section');
    const questions = [];

    async function submitQuestion() {
      const username = document.getElementById('username').value.trim();
      const question = document.getElementById('question').value.trim();
      if (!username || !question) {
        alert("Vui l√≤ng nh·∫≠p ƒë·∫ßy ƒë·ªß th√¥ng tin!");
        return;
      }

      // G·ª≠i l√™n Google Form
      const formURL = 'https://docs.google.com/forms/u/0/d/e/1FAIpQLScMnnE_qLihGp_8KKnUglc1aap2mLtlDO96aABi323ua8FYQw/formResponse';
      const formData = new FormData();
      formData.append('entry.627679237', username); // T√™n
      formData.append('entry.598787276', question); // C√¢u h·ªèi

      try {
        await fetch(formURL, {
          method: 'POST',
          mode: 'no-cors',
          body: formData
        });

        alert("üéâ C√¢u h·ªèi c·ªßa b·∫°n ƒë√£ ƒë∆∞·ª£c g·ª≠i!");
        document.getElementById('username').value = '';
        document.getElementById('question').value = '';

        // T·ª± th√™m v√†o giao di·ªán m√† kh√¥ng c·∫ßn ƒë·ª£i c·∫≠p nh·∫≠t sheet
        questions.unshift({ username, question, answer: '' });
        renderQuestions(questions);
      } catch (err) {
        alert("ƒê√£ x·∫£y ra l·ªói khi g·ª≠i c√¢u h·ªèi.");
        console.error(err);
      }
    }

    function renderQuestions(data) {
      const oldCards = document.querySelectorAll('.answer-box');
      oldCards.forEach(card => card.remove());

      data.forEach(q => {
        const box = document.createElement('div');
        box.className = 'answer-box';
        box.innerHTML = `
          <h3>${q.username} h·ªèi:</h3>
          <p>${q.question}</p>
          <hr>
          <p><i>${q.answer && q.answer.trim() !== '' ? q.answer : 'Ch·ªù tr·∫£ l·ªùi...'}</i></p>
        `;
        qaSection.appendChild(box);
      });
    }

    async function fetchSheetQuestions() {
      try {
        const res = await fetch(sheetURL);
        const data = await res.json();

        if (!Array.isArray(data)) {
          console.error('D·ªØ li·ªáu t·ª´ Sheet kh√¥ng h·ª£p l·ªá:', data);
          return;
        }

        const sheetQuestions = data.map(item => ({
          username: item.T√™n || '·∫®n danh',
          question: item['C√¢u h·ªèi'] || '',
          answer: item['Tr·∫£ l·ªùi'] || ''
        })).reverse();

        questions.push(...sheetQuestions);
        renderQuestions(questions);
      } catch (err) {
        console.error('Kh√¥ng th·ªÉ t·∫£i d·ªØ li·ªáu t·ª´ Google Sheet:', err);
      }
    }

    fetchSheetQuestions();
  </script>
</body>
</html>
